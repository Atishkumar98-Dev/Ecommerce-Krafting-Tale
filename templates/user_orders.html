{% extends 'root.html' %}
{% load static %}
{% block content %}
<style>
    body {
        background-color: #f8f8f8;
        font-family: 'Poppins', sans-serif;
    }

    h2 {
        color: #b58555;
        margin-bottom: 20px;
        font-weight: 600;
    }

    .order-card {
        border-radius: 12px;
        overflow: hidden;
        margin-bottom: 30px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        background-color: #fff;
    }

    .order-header {
        padding: 15px 20px;
        font-weight: 600;
        font-size: 1rem;
    }

    .bg-warning {
        background-color: #FFF2CC !important;
        color: #5a4b00 !important;
    }

    .bg-success {
        background-color: #9FC088 !important;
        color: #1a3b00 !important;
    }

    .order-item {
        display: flex;
        align-items: center;
        padding: 15px 20px;
        border-bottom: 1px solid #f0f0f0;
        gap: 15px;
    }

    .order-item:last-child {
        border-bottom: none;
    }

    .product-img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 8px;
        flex-shrink: 0;
    }

    .product-details {
        flex-grow: 1;
    }

    .product-details strong {
        display: block;
        margin-bottom: 5px;
        color: #b58555;
    }

    .product-details span {
        font-size: 0.95rem;
        color: #555;
    }

    .price {
        font-weight: 600;
        color: #333;
    }

    .pagination {
        justify-content: center;
    }
</style>

<div class="container mt-4 mb-5">
    <h2>Your Orders</h2>

    {% for order in user_orders %}
    <div class="order-card">
        <div class="order-header {% if order.delivery_status == 'In Progress' or order.delivery_status == 'Pending' %} bg-warning {% else %} bg-success {% endif %}">
            Order #{{ order.id }} | Transaction: {{ order.status }} | Delivery: {{ order.delivery_status }} | Total: ₹ {{ order.total_price }}
        </div>
        <div class="card-body p-0">
          {% for item in order.orderitem_set.all %}
<div class="order-item d-flex align-items-center mb-3 p-2 border rounded shadow-sm">
    <img src="{{ item.product_variant.image.url }}" alt="{{ item.product_variant.name }}" class="product-img me-3" style="width:80px; height:80px; object-fit:cover; border-radius:8px;">
    <div class="product-details">
        <strong>{{ item.product_variant.name }}</strong><br>
        Quantity: {{ item.quantity }}<br>
        <span class="price">₹ {{ item.product_variant.price|floatformat:"2" }}</span>
    </div>
</div>
{% endfor %}
        </div>
    </div>
    {% endfor %}

    <!-- Pagination -->
    <nav aria-label="Page navigation">
        <ul class="pagination mt-4">
            {% if user_orders.has_previous %}
                <li class="page-item">
                    <a href="?page=1" class="page-link">&laquo;&laquo;</a>
                </li>
                <li class="page-item">
                    <a href="?page={{ user_orders.previous_page_number }}" class="page-link">&laquo;</a>
                </li>
            {% endif %}

            <li class="page-item disabled">
                <span class="page-link">Page {{ user_orders.number }} of {{ user_orders.paginator.num_pages }}</span>
            </li>

            {% if user_orders.has_next %}
                <li class="page-item">
                    <a href="?page={{ user_orders.next_page_number }}" class="page-link">&raquo;</a>
                </li>
                <li class="page-item">
                    <a href="?page={{ user_orders.paginator.num_pages }}" class="page-link">&raquo;&raquo;</a>
                </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endblock content %}
