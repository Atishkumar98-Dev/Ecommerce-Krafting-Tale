{% extends 'root.html' %} {% load static %} {% block content %}

    <!-- Link Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <style>
    
       
    .list-group-item .d-flex{
        width: 50%;
    }
        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: rgba(0, 0, 0, 0.19) 0px 10px 20px, rgba(0, 0, 0, 0.23) 0px 6px 6px;
        }

        .order-info {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        


        /* Additional styling for form and button alignment */
        form {
            margin-bottom: 20px;
        }

        /* Responsive margin for Pay Now button */
        @media (max-width: 576px) {
            .btn-primary {
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>

    <div class="container mt-4">
        <h1 class="mb-4">Checkout / Order Summary </h1>

        
        
        <div class="card mb-4 mt-5">
        <div class="card-header bg-success text-white">
            Order #{{ order.id }} - Status: {{ order.status }}
        </div>
        <div class="card-body">
            <ul class="list-group">
                {% for item in order.orderitem_set.all %}
                <li class="list-group-item">
                    <div class="d-flex justify-content-between align-items-center">
                        <span>
                                Product: {{ item.product_variant.name }}
                                <br>
                                Quantity: {{ item.quantity }}
                                <br>
                                Price: ₹ {{ item.product_variant.price }}
                            </span>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="order-info">
            <p><b class="text-warning">Shipping Address: {{ customer.shipping_address }}</b></p>
       </div>
        <div class="order-info">
             <p><b class="text-success">Total Price: ₹ {{ total_price }}</b></p>
        </div>

        <button class="btn btn-success" type="submit" onclick="openCheckout()">Pay Now</button>
    </div>
    
    <!-- Link Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        var options = {
            key: '{{ settings.RAZORPAY_API_KEY }}',
            amount: '{{ total_price }}',
            currency: 'INR',
            name: 'Deal Duniya',
            description: 'Payment for your product or service',
            // image: 'your_logo_url',
            order_id: '{{ razor_pay_order.id }}',
            handler: function (response) {
                window.location.href = `http://127.0.0.1:8055/order_success/?razorpay_payment_id=${response.razorpay_payment_id}&razorpay_order_id=${response.razorpay_order_id}&razorpay_signature=${response.razorpay_signature}`;
            }
        };

        function openCheckout() {
            var rzp = new Razorpay(options);
            rzp.open();
        }
    </script>

{% endblock content%}

